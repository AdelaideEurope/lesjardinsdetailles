<div class="container custom-container">
  <div class="search-form">
  <%= form_tag produits_path, method: :get, class: "search-input" do %>
    <%= text_field_tag :query, params[:query], class: "form-control", placeholder: "Chercher un produit" %>
    <button type="submit" class="btn search-button" id="submit">
      <i class="fas fa-search"></i>
    </button>
  <% end %>
  </div>

  <div class="d-flex mx-auto flex-wrap justify-content-sm-between justify-content-center">
    <% @products.each do |product| %>
      <div class="mt-4 product-card" style="box-shadow: 0px 2px 4px 0px <%= product.color.nil? ? '#276259' : product.color %>;">
        <div class="card-colored-top-part" style="background: <%= product.color.nil? ? '#276259' : product.color %>">
          <div class="card-top-part-text"><%= product.name.capitalize %></div>
        </div>
        <%#= cl_image_tag @products[0].photo.key, class: "card-product-img" %>
        <div class="card-bottom-part">
          <div class="card-bottom-part-text">
            <div class="card-main-info-top-right">122¬†‚Ç¨</div>
            <p class="mt-2">Ceci est un bloc de texte basique, blabla bla blabla</p>
          </div>
          <div class="d-flex justify-content-end">
            <div class="card-bottom-right-triangle" style="background: linear-gradient(to bottom right, #fff 0%, #fff 50%, <%= product.color.nil? ? '#276259' : product.color %> 50%, <%= product.color.nil? ? '#276259' : product.color %> 100%)" data-drawer-trigger aria-controls="drawer-name<%= product.id %>" aria-expanded="false"><i class="fas fa-plus"></i></div>
          </div>
        </div>
      <section class="drawer" id="drawer-name<%= product.id %>" data-drawer-target>
        <div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
        <div class="drawer__wrapper">
          <div class="drawer__header">
            <div class="d-flex justify-content-between">
              <div class="drawer__title d-flex">
                <h1><%= product.name.capitalize %></h1>
                <% if product.photo.attached? %>
                  <%= cl_image_tag product.photo.key, class: "drawer-product-img" %>
                <% end %>
              </div>
              <button class="drawer__close" data-drawer-close aria-label="Close Drawer"></button>
            </div>
          <div style="margin-top: -8px;"><%= product.product_group.name.capitalize %></div>
          </div>
          <div class="drawer__content">
            <div>Nombre de planches <%= Date.today.strftime('%Y') %> : <%= remove_trailing_zero(product.yearly_bed_count) %></div>
            <h2 class="mt-4">Infos culture</h2>
            <div>Rendement par m√®tre carr√© : <%= get_price_in_cents(product.yield_per_sqm) %></div>
            <div>Chiffre d'affaires estim√© : <%= get_price_in_cents(product.estimated_turnover) %></div>
            <div>Espacement : <%= show_replace_nil_with_dash(product.spacing) %></div>
            <div>Nombre de rangs : <%= product.row_count %></div>
            <div>Perte : <%= product.loss_percentage %>¬†%</div>
            <div>Dur√©e de croissance en semaines : <%= product.growth_duration_in_weeks %></div>
            <div>Dur√©e de r√©colte en semaines : <%= product.harvest_duration_in_weeks %></div>

            <h2 class="mt-4">Money money money üíµ</h2>
            <div>Prix g√©n√©ral : <%= get_price_in_cents(product.general_price_final_client) %>/<%= product.general_unit %></div>
            <div>Prix g√©n√©ral interm√©diaire : <%= get_price_in_cents(product.general_price_intermediary) %>/<%= product.general_unit %></div>
            <div>Chiffre d'affaires HT : <%= get_price_in_cents(product.ht_turnover) %></div>
            <div>Chiffre d'affaires TTC : <%= get_price_in_cents(product.ttc_turnover) %></div>
          </div>
        </div>
      </section>
      </div>
    <% end %>
  </div>
</div>


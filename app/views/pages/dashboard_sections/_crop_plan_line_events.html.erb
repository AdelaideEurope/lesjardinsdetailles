<div class="mb-4 mb-sm-0 dashboard-crop-plan-line-card green w-48-desktop">
  <div class="card-colored-top-part-fixed-color green">
    <div class="card-top-part-text">From the plan de culture</div>
  </div>
  <div class="card-bottom-part">
    <div class="card-bottom-part-text">
      <div class="mt-3">
        <% if !week_planting.empty? %>
          <h3>Plantation et semis directs</h3>
        <% end %>
        <% week_planting.each do |planting| %>
          <div class="d-flex justify-content-between card-list-item-block">
            <div class="card-list-item-left-block">
              <div class="desktop_only">
                <div class="round-button green m-2">
                  <i class="fas fa-check round-txt-button"></i>
                </div>
              </div>
              <div class="card-list-item-main-info-block">
                <div>
                  <p><%= planting.product.name.capitalize %></p>
                </div>
                <div class="card-list-item-second-line"><%= planting.bed.garden.name %> - <%= planting.bed.name %></div>
              </div>
            </div>
            <div class="d-flex justify-content-between card-list-item-round-button-block">
              <div>
                <div class="round-button green mobile_only m-2">
                  <i class="fas fa-check round-txt-button"></i>
                </div>
              </div>
              <div class="d-flex">
                <div class="round-button green m-2" data-drawer-trigger aria-controls="drawer-info-<%= planting.id %>" aria-expanded="false">
                  <i class="fas fa-search round-txt-button"></i>
                </div>
                <div class="round-button <%= planting.comment.nil? || planting.comment.empty? ? 'lightgrey' : 'green' %>  m-2" data-drawer-trigger aria-controls="drawer-<%= planting.id %>" aria-expanded="false">
                  <i class="fas fa-comment round-txt-button"></i>
                </div>
                <%= link_to farm_plandeculture_path(farm, planting, postpone: true, start_date: params[:start_date]), method: :patch do %>
                  <div class="round-button orange m-2">
                    <i class="fas fa-redo-alt round-txt-button"></i>
                  </div>
                <% end %>
              </div>
              <div>
                <div class="txt-avatar <%= current_user.color %> m-2"><%= current_user.initial %></div>
              </div>
            </div>
          </div>
          <!-- drawer commentaire -->
          <section class="drawer" id="drawer-<%= planting.id %>" data-drawer-target>
              <div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
              <div class="drawer__wrapper">
                <div class="drawer__header">
                  <div class="d-flex justify-content-between">
                    <div class="drawer__title">
                      <div>
                        <h2><%= planting.product.name.capitalize %></h2>
                      </div>
                    </div>
                    <button class="drawer__close" data-drawer-close aria-label="Close Drawer">
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>
                <div class="drawer__content">
                  <h4 class="pt-3">Commentaire</h4>
                    <% if planting.comment.nil? || planting.comment.empty? %>
                      <p>Pas de commentaire</p>
                    <% else %>
                      <p>
                        <%= planting.comment&.capitalize %>
                      <p>
                    <% end %>
                </div>
              </div>
          </section>
          <!-- drawer info -->
          <section class="drawer" id="drawer-info-<%= planting.id %>" data-drawer-target>
            <div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
            <div class="drawer__wrapper">
              <div class="drawer__header">
                <div class="d-flex justify-content-between">
                  <div class="drawer__title">
                    <div>
                      <h2><%= planting.product.name.capitalize %></h2>
                    </div>
                    <div class="drawer-title-second-line"><%= planting.bed.garden.name %> - <%= planting.bed.name %></div>
                  </div>
                  <button class="drawer__close" data-drawer-close aria-label="Close Drawer">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
              <div class="drawer__content">
                <h4 class="pt-3">Comment planter</h4>
              </div>
            </div>
          </section>
        <% end %>

        <div class="mt-3">
          <h3>Semis en pépinière</h3>
          <div class="d-flex justify-content-between card-list-item-block">
            <div class="card-list-item-left-block">
              <div class="desktop_only">
                <div class="round-button green m-2">
                  <i class="fas fa-check round-txt-button"></i>
                </div>
              </div>
              <div class="card-list-item-main-info-block">
                <div>
                  <p>Courge</p>
                </div>
                <div class="card-list-item-second-line">100 godets | 2 graines par godet</div>
              </div>
            </div>
            <div class="d-flex justify-content-between card-list-item-round-button-block">
              <div>
                <div class="round-button green mobile_only m-2">
                  <i class="fas fa-check round-txt-button"></i>
                </div>
              </div>
              <div class="d-flex">
                <div class="round-button lightgrey m-2">
                  <i class="fas fa-comment round-txt-button"></i>
                </div>
                <div class="round-button orange m-2">
                  <i class="fas fa-redo-alt round-txt-button"></i>
                </div>
              </div>
              <div>
                <div class="txt-avatar olive m-2"><%= current_user.initial %></div>
              </div>
            </div>
          </div>
        </div>
        <div class="mt-3">
          <% if !week_bed_preparation_2_weeks.empty? || !week_bed_preparation_1_week.empty? %>
            <h3>Préparation planche</h3>
          <% end %>
          <% if !week_bed_preparation_1_week.empty? %>
            <a class="collapsable-garden-name" data-toggle="collapse" href="#collapse-next-week-<%= params[:start_date] %>" aria-expanded="false" aria-controls="collapse-next-week-<%= params[:start_date] %>">
              <div class="d-flex"><h5>Pour plantation la semaine pro</h5><i class="fa" aria-hidden="true"></i></div>
            </a>
            <div class="collapse show" id="collapse-next-week-<%= params[:start_date] %>">
              <%week_bed_preparation_1_week.each do |preparing| %>
                <div class="d-flex justify-content-between card-list-item-block">
                  <div class="card-list-item-left-block">
                    <div class="desktop_only">
                      <div class="round-button green m-2">
                        <i class="fas fa-check round-txt-button"></i>
                      </div>
                    </div>
                    <div class="card-list-item-main-info-block">
                      <div>
                        <p><%= preparing.bed.garden.name %> - <%= preparing.bed.name %></p>
                      </div>
                      <div class="card-list-item-second-line"><%= preparing.product.name.capitalize %></div>
                      <div class="card-list-item-second-line"><!-- 700g Patenkali - 2kg Bioguanor --></div>
                    </div>
                  </div>
                  <div class="d-flex justify-content-between card-list-item-round-button-block">
                    <div>
                      <div class="round-button green mobile_only m-2">
                        <i class="fas fa-check round-txt-button"></i>
                      </div>
                    </div>
                    <div class="d-flex">
                      <div class="round-button green m-2" data-drawer-trigger aria-controls="drawer-info-<%= preparing.id %>" aria-expanded="false">
                        <i class="fas fa-search round-txt-button"></i>
                      </div>
                      <div class="round-button green m-2" data-drawer-trigger aria-controls="drawer-comment-<%= preparing.id %>" aria-expanded="false">
                        <i class="fas fa-comment round-txt-button"></i>
                      </div>
                      <div class="round-button orange m-2">
                        <i class="fas fa-redo-alt round-txt-button"></i>
                      </div>
                    </div>
                    <div>
                      <div class="txt-avatar orange m-2"><%= current_user.last_name[0] %></div>
                    </div>
                  </div>
                </div>
                <!-- drawer commentaire -->
                <section class="drawer" id="drawer-comment-<%= preparing.id %>" data-drawer-target>
                    <div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
                    <div class="drawer__wrapper">
                      <div class="drawer__header">
                        <div class="d-flex justify-content-between">
                          <div class="drawer__title">
                            <div>
                              <h2><%= preparing.product.name.capitalize %></h2>
                            </div>
                          </div>
                          <button class="drawer__close" data-drawer-close aria-label="Close Drawer">
                            <i class="fas fa-times"></i>
                          </button>
                        </div>
                      </div>
                      <div class="drawer__content">
                        <h4 class="pt-3">Commentaire</h4>
                          <% if preparing.comment.nil? || preparing.comment.empty? %>
                            <p>Pas de commentaire</p>
                          <% else %>
                            <p>
                              <%= preparing.comment&.capitalize %>
                            <p>
                          <% end %>
                      </div>
                    </div>
                </section>
                <!-- drawer info -->
                <section class="drawer" id="drawer-info-<%= preparing.id %>" data-drawer-target>
                    <div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
                    <div class="drawer__wrapper">
                      <div class="drawer__header">
                        <div class="d-flex justify-content-between">
                          <div class="drawer__title">
                            <div>
                              <h2><%= preparing.product.name.capitalize %></h2>
                            </div>
                            <div class="drawer-title-second-line"><%= preparing.bed.garden.name %> - <%= preparing.bed.name %></div>
                          </div>
                          <button class="drawer__close" data-drawer-close aria-label="Close Drawer">
                            <i class="fas fa-times"></i>
                          </button>
                        </div>
                      </div>
                      <div class="drawer__content">
                        <h4 class="pt-3">À préparer</h4>
                      </div>
                    </div>
                </section>
              <% end %>
            </div>
          <% end %>

          <a class="collapsable-garden-name collapsed" data-toggle="collapse" href="#collapse-two-weeks-<%= params[:start_date] %>" aria-expanded="false" aria-controls="collapse-two-weeks-<%= params[:start_date] %>">
            <div class="d-flex mt-2"><h5>Pour plantation dans deux semaines</h5><i class="fa" aria-hidden="true"></i></div>
          </a>
          <div class="collapse" id="collapse-two-weeks-<%= params[:start_date] %>">
            <% week_bed_preparation_2_weeks.each do |preparing| %>
              <div class="d-flex justify-content-between card-list-item-block">
                <div class="card-list-item-left-block">
                  <div class="desktop_only">
                    <div class="round-button green m-2">
                      <i class="fas fa-check round-txt-button"></i>
                    </div>
                  </div>
                  <div class="card-list-item-main-info-block">
                    <div>
                      <p><%= preparing.bed.garden.name %> - <%= preparing.bed.name %></p>
                    </div>
                    <div class="card-list-item-second-line"><%= preparing.product.name.capitalize %></div>
                    <div class="card-list-item-second-line"><!-- 700g Patenkali - 2kg Bioguanor --></div>
                  </div>
                </div>
                <div class="d-flex justify-content-between card-list-item-round-button-block">
                  <div>
                    <div class="round-button green mobile_only m-2">
                      <i class="fas fa-check round-txt-button"></i>
                    </div>
                  </div>
                  <div class="d-flex">
                    <div class="round-button green m-2" data-drawer-trigger aria-controls="drawer-info-<%= preparing.id %>" aria-expanded="false">
                      <i class="fas fa-search round-txt-button"></i>
                    </div>
                    <div class="round-button green m-2" data-drawer-trigger aria-controls="drawer-comment-<%= preparing.id %>" aria-expanded="false">
                      <i class="fas fa-comment round-txt-button"></i>
                    </div>
                    <div class="round-button orange m-2">
                      <i class="fas fa-redo-alt round-txt-button"></i>
                    </div>
                  </div>
                  <div>
                    <div class="txt-avatar orange m-2"><%= current_user.last_name[0] %></div>
                  </div>
                </div>
              </div>
              <!-- drawer commentaire -->
              <section class="drawer" id="drawer-comment-<%= preparing.id %>" data-drawer-target>
                  <div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
                  <div class="drawer__wrapper">
                    <div class="drawer__header">
                      <div class="d-flex justify-content-between">
                        <div class="drawer__title">
                          <div>
                            <h2><%= preparing.product.name.capitalize %></h2>
                          </div>
                        </div>
                        <button class="drawer__close" data-drawer-close aria-label="Close Drawer">
                          <i class="fas fa-times"></i>
                        </button>
                      </div>
                    </div>
                    <div class="drawer__content">
                      <h4 class="pt-3">Commentaire</h4>
                        <% if preparing.comment.nil? || preparing.comment.empty? %>
                          <p>Pas de commentaire</p>
                        <% else %>
                          <p>
                            <%= preparing.comment&.capitalize %>
                          <p>
                        <% end %>
                    </div>
                  </div>
              </section>
              <!-- drawer info -->
              <section class="drawer" id="drawer-info-<%= preparing.id %>" data-drawer-target>
                  <div class="drawer__overlay" data-drawer-close tabindex="-1"></div>
                  <div class="drawer__wrapper">
                    <div class="drawer__header">
                      <div class="d-flex justify-content-between">
                        <div class="drawer__title">
                          <div>
                            <h2><%= preparing.product.name.capitalize %></h2>
                          </div>
                          <div class="drawer-title-second-line"><%= preparing.bed.garden.name %> - <%= preparing.bed.name %></div>
                        </div>
                        <button class="drawer__close" data-drawer-close aria-label="Close Drawer">
                          <i class="fas fa-times"></i>
                        </button>
                      </div>
                    </div>
                    <div class="drawer__content">
                      <h4 class="pt-3">À préparer</h4>
                    </div>
                  </div>
              </section>
            <% end %>
          </div>
        </div>


        <div class="mt-3">
          <% if !week_harvesting.empty? %>
            <h3>Dispo pour la récolte cette semaine</h3>
          <% end %>
          <div class="d-flex flex-wrap justify-content-center">
            <% week_harvesting.each do |harvesting| %>
            <div class="d-flex px-sm-2 px-1">
              <div class="d-flex">
                <div class="align-self-center">
                  <p><%= harvesting.product.name.capitalize %> | </p>
                </div>
                <div class="card-list-item-second-line align-self-center"> <%= harvesting.bed.garden.name %> - <%= harvesting.bed.name %></div>
              </div>
              <div class="round-button orange m-sm-2 m-1">
                <i class="fas fa-redo-alt round-txt-button"></i>
              </div>
            </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div id="decharge-mentale-anchor" class="d-flex justify-content-end card-bottom-section-with-icon">
      <%= link_to farm_plandeculture_index_path(current_user.farm_id) do %>
        <div class="card-bottom-right-triangle green">
          <i class="fas fa-seedling" style="padding: 3px 0;"></i>
        </div>
      <% end %>
    </div>
  </div>
</div>
